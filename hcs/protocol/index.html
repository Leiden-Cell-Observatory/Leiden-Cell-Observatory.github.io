
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../publishing/">
      
      
      <link rel="icon" href="../../logo/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Standard Protocol - Leiden Cell Observatory Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hcs-image-analysis-with-cellprofiler" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Leiden Cell Observatory Wiki" class="md-header__button md-logo" aria-label="Leiden Cell Observatory Wiki" data-md-component="logo">
      
  <img src="../../logo/LCO_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Leiden Cell Observatory Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Standard Protocol
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Leiden-Cell-Observatory/Leiden-Cell-Observatory.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Leiden-Cell-Observatory.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../microscopes/" class="md-tabs__link">
          
  
  
    
  
  Microscopes

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../omero/" class="md-tabs__link">
          
  
  
    
  
  OMERO

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../analysis/" class="md-tabs__link">
          
  
  
    
  
  Image analysis

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  High-Content Screening

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../publishing/" class="md-tabs__link">
          
  
  
    
  
  Publishing

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../resources/" class="md-tabs__link">
        
  
  
    
  
  Resources

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contact/" class="md-tabs__link">
        
  
  
    
  
  Contact

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Leiden Cell Observatory Wiki" class="md-nav__button md-logo" aria-label="Leiden Cell Observatory Wiki" data-md-component="logo">
      
  <img src="../../logo/LCO_logo.png" alt="logo">

    </a>
    Leiden Cell Observatory Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Leiden-Cell-Observatory/Leiden-Cell-Observatory.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Leiden-Cell-Observatory.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../microscopes/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Microscopes
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../omero/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    OMERO
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../analysis/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Image analysis
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    High-Content Screening
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            High-Content Screening
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Standard Protocol
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Standard Protocol
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-you-begin" class="md-nav__link">
    <span class="md-ellipsis">
      Before You Begin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-fill-out-mihcsme-file" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Fill Out MIHCSME File
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-preparing-the-nd2-file-and-extracting-tiffs" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Preparing the ND2 File and Extracting TIFFs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-segmentation-of-nuclei" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Segmentation of Nuclei
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-create-loaddata-file-using-in-house-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create LoadData File Using In-House R Script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-run-cellprofiler-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Run CellProfiler Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-retrieve-data-from-mysql-server" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Retrieve Data from MySQL Server
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../publishing/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Publishing
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-you-begin" class="md-nav__link">
    <span class="md-ellipsis">
      Before You Begin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-fill-out-mihcsme-file" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Fill Out MIHCSME File
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-preparing-the-nd2-file-and-extracting-tiffs" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Preparing the ND2 File and Extracting TIFFs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-segmentation-of-nuclei" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Segmentation of Nuclei
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-create-loaddata-file-using-in-house-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create LoadData File Using In-House R Script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-run-cellprofiler-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Run CellProfiler Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-retrieve-data-from-mysql-server" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Retrieve Data from MySQL Server
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Leiden-Cell-Observatory/Leiden-Cell-Observatory.github.io/edit/main/docs/hcs/protocol.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="hcs-image-analysis-with-cellprofiler">HCS Image Analysis with CellProfiler<a class="headerlink" href="#hcs-image-analysis-with-cellprofiler" title="Permanent link"></a></h1>
<p>This protocol is based on CellProfiler version 4.2.5 in combination with the WMC (watershed masked clustering) or StarDist plugin in Fiji for segmentation of nuclei.</p>
<div class="admonition abstract">
<p class="admonition-title">Protocol Overview</p>
<ol>
<li>Extract images to folder as tiffs with standardised filenames (data_personalID_assayID_plateID)</li>
<li>Generate loadData file using an R script</li>
<li>Start CellProfiler, create LoadData module and import loaddata file (solve errors as they appear, CellProfiler sort of tells you what to do)</li>
<li>Prepare analysis pipeline</li>
<li>Add export to database module</li>
<li>Run pipeline</li>
<li>Extract data from database with an R script</li>
<li>Wrangle data and plot in R</li>
</ol>
</div>
<h2 id="before-you-begin">Before You Begin<a class="headerlink" href="#before-you-begin" title="Permanent link"></a></h2>
<div class="admonition info">
<p class="admonition-title">Requirements</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Software you need</label><label for="__tabbed_1_2">Files you need</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Check the ImageAnalysis-Software (<a href="https://github.com/lacdr-tox/ImageAnalysis-Software-WIP">lacdr-tox/ImageAnalysis-Software-WIP</a>) GitHub repository for software installation instructions.<br />
This is currently a private repository. Request access if you do not have it yet.</p>
<ol>
<li>Fiji with StarDist and/or WMC plugins installed</li>
<li>OME.insight - to upload data to OMERO</li>
<li>NIS Elements Viewer - to convert ND2 to TIFFs</li>
<li>CellProfiler (version 4.2.5)</li>
<li>R and RStudio</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li><code>ND2</code> file with your images</li>
<li>MIHCSME file (metadata file) - <a href="../../omero/importing/mihcsme/">Read more here</a></li>
</ol>
</div>
</div>
</div>
</div>
<h2 id="step-1-fill-out-mihcsme-file">Step 1: Fill Out MIHCSME File<a class="headerlink" href="#step-1-fill-out-mihcsme-file" title="Permanent link"></a></h2>
<ol>
<li>Download the example MIHCSME file from the link above.</li>
<li>Open the file in Excel or another spreadsheet program.</li>
</ol>
<h2 id="step-2-preparing-the-nd2-file-and-extracting-tiffs">Step 2: Preparing the ND2 File and Extracting TIFFs<a class="headerlink" href="#step-2-preparing-the-nd2-file-and-extracting-tiffs" title="Permanent link"></a></h2>
<ol>
<li>Manually inspect your images of positive and negative controls in the ND2 file.   </li>
<li><strong>Prepare the file structure:</strong> <br />
   - Create a new folder for your experiment and move the ND2 file into this folder. <br />
   - Change the ND2 file name to the following format:   </li>
</ol>
<div class="admonition note">
<p class="admonition-title">File Naming Convention</p>
<p><strong>Format:</strong> <code>date_personalID_assayID_plateID</code></p>
<ul>
<li><strong>date:</strong> from the original folder name   </li>
<li><strong>Personal ID:</strong> three initials   </li>
<li><strong>assayID:</strong> ID given to assay according to ISA standards (see MIHCSME) - three numbers preceded by 'a'   </li>
<li><strong>plateID:</strong> Number of your plate (plate01, plate02, etc. if you have only one plate use plate01)   </li>
</ul>
<p><strong>Example:</strong></p>
<p>Original name: <br />
- Folder name: <code>20200311_161054_731</code> <br />
- ND2 file name: <code>Seq0000.nd2</code>   </p>
<p>New ND2 filename: <code>20200311_TDA_a002_plate01.nd2</code>   </p>
</div>
<ol start="3">
<li>
<p>After you have renamed the file, import the ND2 file into <strong>OMERO</strong> following steps here: <a href="../../omero/importing/hcs-data/">OMERO import instructions</a>. Also attach the MIHCSME file to the <code>Plate</code> in OMERO.   </p>
</li>
<li>
<p><strong>Export ND2 file as TIFFs:</strong>   </p>
<ol>
<li>Open the ND2 file in NIS Elements Viewer.</li>
<li>Go to File &gt; Save/Export to TIFF Files.</li>
<li>Select the output folder (the same as the input folder or browse the location of the original ND2 file).</li>
<li>Select Subfolder: <code>&lt;User defined&gt;</code> TIFFs, Name: <code>&lt;Original name&gt;</code>.</li>
<li>Choose Standard TIFF.</li>
<li>Select Split to Multiple Files.</li>
<li>Change dimensions to order <code>&lt;xy&gt; &lt;t&gt; &lt;c&gt;</code>.</li>
<li>Use point Names and do not use channel Names. <strong>(example image is wrong)</strong></li>
<li>Only export to mono image for each channel.</li>
<li>Do not apply LUTs.</li>
<li>Click Export.</li>
</ol>
</li>
</ol>
<p>Files <strong>without</strong> time points: <br />
<img alt="alt text" src="../images/image1.png" /> <br />
Files <strong>with</strong> timepoints: (notice extra dimension) <br />
<img alt="alt text" src="../images/image2.png" /></p>
<h2 id="step-3-segmentation-of-nuclei">Step 3: Segmentation of Nuclei<a class="headerlink" href="#step-3-segmentation-of-nuclei" title="Permanent link"></a></h2>
<ol>
<li>Segment nuclei using stardist macro in Fiji</li>
<li>Open Fiji</li>
<li>Open one Hoechst image in Fiji. (a TIFF of channel <code>C1</code>. Drag into Fiji window)</li>
<li>Go to <code>Plugins &gt; stardist &gt; stardist 2D</code>.</li>
<li>Run once. (check <code>normalize</code> box)</li>
<li>Change settings if needed.</li>
<li>Repeat step 2 and 4 until you are satisfied with the segmentation of the nuclei.</li>
<li>Save the settings.</li>
</ol>
<p><img alt="alt text" src="../images/image3.png" /></p>
<ol start="9">
<li>Click Cancel and close the currently opened image.   </li>
<li>Click <code>Plugins - Macros - Edit</code> and navigate to and open <code>stardist_Batch.ijm</code> - click <code>Run</code>   </li>
<li>Drag the folder containing images into <code>Select Image Files Folders</code>. Select Hoechst images and correct settings.  <br />
    Hoechst is usually the first channel (C1), so for <code>filter by regExp</code> write: <code>.*C1.tif.*</code> (look up regular expression if you would like to know what this means exactly)</li>
</ol>
<div class="admonition info">
<p class="admonition-title">File Selection</p>
<p>This selects for all files containing <code>C1.tif</code> which will be your Hoechst images.</p>
<p>(if C1 is not at the end of your filename, you used a different order of dimensions in step 4.g.<br />
You can fix this by extracting your images again with the correct order of dimensions or by writing another regExp here and by changing the regExp in the loaddata script in step 4.e)</p>
</div>
<ol start="12">
<li>Check if your folder now contains segmented images.   </li>
</ol>
<h2 id="step-4-create-loaddata-file-using-in-house-r-script">Step 4: Create LoadData File Using In-House R Script<a class="headerlink" href="#step-4-create-loaddata-file-using-in-house-r-script" title="Permanent link"></a></h2>
<p>After steps 2 and 3, you should have a folder named TIFFs containing all <code>.tif</code> images and <code>stardist_mask.png</code> images based on your Hoechst channel <code>.tifs</code>.</p>
<p>Using an R script, extract useful data from the filenames and create a metadata file in Excel.   </p>
<ol>
<li><strong>Create metadata file in Excel</strong> (if MIHCSME file was not already created in Step 1):<ol>
<li>Open MIHCSME file (on github)</li>
<li>Fill out as much assay related information as possible in first three sheets.</li>
<li>Fill out assay conditions in sheet 4.</li>
<li>Column names must contain:<ol>
<li>Plate</li>
<li>Well</li>
</ol>
</li>
<li>Add columns relevant to your experiment:<ol>
<li>Such as <code>Treatment</code></li>
<li><code>Dose</code></li>
</ol>
</li>
<li>Save file as <code>.xlsx</code> file   </li>
</ol>
</li>
</ol>
<p><img alt="alt text" src="../images/image4.png" /></p>
<ol>
<li>
<p><strong>Launch <code>Generate_LoadData_file.R</code></strong></p>
<ol>
<li>Found on the github in folder <code>R_scripts</code> </li>
</ol>
</li>
<li>
<p><strong>Fill in variables:</strong></p>
<ol>
<li>path.TIFFS = the path to your <code>TIFFs</code> folder.<br />
   (for example C:\Users\You\documents\Experiment1\CellLineX\TIFFs)</li>
<li>path.master = the path to your output folder.<br />
   Usually the one containing your nd2 file (C:\Users\You\documents\Experiment1\CellLineX)</li>
<li>Timepoints <code>Yes</code> or <code>No</code>. does your filename contain timepoint information (as seen in step 4)</li>
<li>Image sets: enable lines with relevant imagetypes. Often:<ol>
<li>ObjectsFileName_mask</li>
<li>Image_FileName_image_hoechst</li>
<li>Image_FileName_image_pi</li>
<li>Image_FileName_image_gfp</li>
</ol>
</li>
<li>Scroll down and enter path to filled out MIHCSME file</li>
<li>Change name of EXPID-PLACEHOLDER to experiment ID</li>
<li>Run whole script</li>
<li>(Fix errors where necessary)</li>
</ol>
</li>
</ol>
<h2 id="step-5-run-cellprofiler-analysis">Step 5: Run CellProfiler Analysis<a class="headerlink" href="#step-5-run-cellprofiler-analysis" title="Permanent link"></a></h2>
<ol>
<li>
<p><strong>Pipeline requirements:</strong></p>
<ul>
<li>LoadData module</li>
<li>ExportToDatabase module</li>
</ul>
</li>
<li>
<p><strong>Configure LoadData module:</strong></p>
<ol>
<li>Refer to file created in step 4 (input file location)</li>
<li>Load images based on his data? <strong>YES</strong></li>
<li>Refer to TIFFs folder for base image location.</li>
</ol>
</li>
</ol>
<p><img alt="alt text" src="../images/image5.png" /></p>
<ol start="3">
<li>
<p>Design your own pipeline after LoadData.<br />
   You can refer to the sop of your colleagues.</p>
</li>
<li>
<p>End pipeline with ExportToDatabase module</p>
</li>
<li>
<p><strong>Create database:</strong></p>
<ol>
<li>Launch mySQL workbench</li>
<li>Create database in query by running command <code>CREATE DATABASE databaseName;</code></li>
<li>(when necessary delete database with <code>DROP DATABASE databaseName;</code>)</li>
</ol>
</li>
</ol>
<p><img alt="alt text" src="../images/image6.png" /></p>
<ol start="6">
<li><strong>Connect CellProfiler to database:</strong><ol>
<li>Database type = MySQL</li>
<li>Experiment name = whatever you want</li>
<li>Database name = the name you chose for the database when using <code>CREATE DATABASE</code></li>
<li>Database host = localhost</li>
<li>username = yourname</li>
<li>Password = your password</li>
<li>Test connection.<br />
   (if connection failed check your previously entered info)</li>
<li>Calculate per image mean, median and standard deviation.</li>
</ol>
</li>
</ol>
<p><img alt="alt text" src="../images/image7.png" /></p>
<ol start="7">
<li>Run pipeline</li>
</ol>
<h2 id="step-6-retrieve-data-from-mysql-server">Step 6: Retrieve Data from MySQL Server<a class="headerlink" href="#step-6-retrieve-data-from-mysql-server" title="Permanent link"></a></h2>
<p>After running CellProfiler, your data is stored in SQL database. The data has to be retrieved and imported into R for wrangling.</p>
<ol>
<li>
<p><strong>Launch <code>SQL_Get_CP_Data.R</code></strong></p>
<ol>
<li>Found on the github in folder <code>R_scripts</code></li>
</ol>
</li>
<li>
<p>Scroll all the way down</p>
</li>
<li>
<p><strong>Change server data:</strong></p>
<ol>
<li>Dbname = <code>[name of your database]</code> (determined earlier)</li>
<li>Host = <code>localhost</code></li>
<li>Port = 3306 (probably, check in SQL workbench)</li>
<li>User = your SQL username</li>
<li>Password = <code>your SQL password</code></li>
</ol>
</li>
<li>
<p>Change path to your experiment folder</p>
</li>
<li>
<p>Change filename to something relevant</p>
</li>
<li>
<p>Run the full script</p>
</li>
<li>
<p>When you have extracted all your data → delete your database using <code>DROP DATABASE databaseName;</code> in mySQL workbench</p>
</li>
<li>
<p>Start wrangling your data!</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Data Extraction</p>
<p>You can pull your data from the database at any point during the analysis.<br />
It does not have to be finished to do some preliminary checks.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: High-Content Screening">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                High-Content Screening
              </div>
            </div>
          </a>
        
        
          
          <a href="../../publishing/" class="md-footer__link md-footer__link--next" aria-label="Next: Publishing">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Publishing
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © Copyright 2025 Leiden Cell Observatory, Leiden University. All content is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/"> Creative Commons Attribution 4.0 International License</a>.

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Leiden-Cell-Observatory" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.universiteitleiden.nl/en/science/cell-observatory" target="_blank" rel="noopener" title="www.universiteitleiden.nl" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.indexes", "navigation.top", "toc.follow", "navigation.footer", "navigation.expand", "navigation.prune", "navigation.collapsible", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "content.action.edit"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>